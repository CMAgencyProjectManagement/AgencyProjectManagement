{"version":3,"sources":["D:/Project/AgencyProjectManagement/Web/Angular/src/app/views/dashboard/dashboard-routing.module.ts","D:/Project/AgencyProjectManagement/Web/Angular/src/app/views/dashboard/dashboard.component.html","D:/Project/AgencyProjectManagement/Web/Angular/src/app/views/dashboard/dashboard.component.ts","D:/Project/AgencyProjectManagement/Web/Angular/src/app/views/dashboard/dashboard.module.ts"],"names":[],"mappings":"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","file":"dashboard.module.chunk.js","sourcesContent":["import {NgModule} from '@angular/core';\r\nimport {\r\n  Routes,\r\n  RouterModule\r\n} from '@angular/router';\r\n\r\nimport {DashboardComponent} from './dashboard.component';\r\n\r\nconst routes: Routes = [\r\n  {\r\n    path: '',\r\n    component: DashboardComponent,\r\n    data: {\r\n      title: 'Dashboard'\r\n    }\r\n  }\r\n\r\n];\r\n\r\n@NgModule({\r\n  imports: [RouterModule.forChild(routes)],\r\n  exports: [RouterModule]\r\n})\r\nexport class DashboardRoutingModule {\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// D:/Project/AgencyProjectManagement/Web/Angular/src/app/views/dashboard/dashboard-routing.module.ts","module.exports = \"<div class=\\\"row\\\">\\r\\n  <div class=\\\"col-md-12\\\">\\r\\n    <div class=\\\"card\\\">\\r\\n      <div class=\\\"card-header\\\">\\r\\n        <strong>\\r\\n          <div>Dashboard</div>\\r\\n        </strong>\\r\\n      </div>\\r\\n      <app-spinner *ngIf=\\\"isLoading.page\\\"></app-spinner>\\r\\n      <div class=\\\"card-body\\\" *ngIf=\\\"!isLoading.page\\\">\\r\\n        <div class=\\\"row\\\">\\r\\n          <div class=\\\"col-lg-7 col-md-10\\\">\\r\\n            <app-staff-section [lateTasks]=l ateTasks [thisWeekTasks]=\\\"thisWeekTasks\\\" *ngIf=\\\"role == 'staff'\\\"></app-staff-section>\\r\\n            <app-manager-section\\r\\n              [lateTasks]=\\\"lateTasks\\\"\\r\\n              [needReviewTasks]=\\\"needReviewTasks\\\"\\r\\n              *ngIf=\\\"role == 'manager'\\\">\\r\\n            </app-manager-section>\\r\\n            <app-admin-section\\r\\n              [projects]=\\\"projects\\\"\\r\\n              *ngIf=\\\"role == 'admin'\\\"></app-admin-section>\\r\\n          </div>\\r\\n          <div class=\\\"col-lg-5 col-md-10\\\">\\r\\n            <div class=\\\"card p-0\\\">\\r\\n              <div class=\\\"card-body\\\">\\r\\n                <h4 class=\\\"card-title col-12\\\">Leader board</h4>\\r\\n                <table class=\\\"table\\\">\\r\\n                  <thead>\\r\\n                    <tr>\\r\\n                      <th class=\\\"text-center\\\">Rank</th>\\r\\n                      <th class=\\\"text-center\\\">Name</th>\\r\\n                      <tH class=\\\"text-center\\\">Score</tH>\\r\\n                    </tr>\\r\\n                  </thead>\\r\\n                  <tbody>\\r\\n                    <tr *ngFor=\\\"let item of leaderboard;let i = index\\\">\\r\\n                      <td class=\\\"text-center\\\">{{i+1}}</td>\\r\\n                      <td class=\\\"text-center\\\">{{item.name}}</td>\\r\\n                      <td class=\\\"text-center\\\">{{item.score}}</td>\\r\\n                    </tr>\\r\\n                  </tbody>\\r\\n                </table>\\r\\n              </div>\\r\\n            </div>\\r\\n          </div>\\r\\n        </div>\\r\\n      </div>\\r\\n    </div>\\r\\n  </div>\\r\\n</div>\\r\\n\"\n\n\n//////////////////\n// WEBPACK FOOTER\n// D:/Project/AgencyProjectManagement/Web/Angular/src/app/views/dashboard/dashboard.component.html\n// module id = ../../../../../src/app/views/dashboard/dashboard.component.html\n// module chunks = dashboard.module","import {Component, OnInit} from '@angular/core';\r\nimport {ActivatedRoute, Router} from '@angular/router';\r\nimport {Project} from '../../interfaces/project';\r\nimport {StoreService} from '../../services/tree.service';\r\nimport {ProjectService} from '../../services/project.service';\r\nimport {Location} from '@angular/common';\r\nimport {BsModalService} from 'ngx-bootstrap';\r\nimport {ErrorModalComponent} from '../../cmaComponents/modals';\r\nimport {UserService} from '../../services/user.service';\r\nimport {User} from '../../interfaces/user';\r\nimport {Task} from '../../interfaces/Task';\r\nimport {TeamService} from '../../services/team.service';\r\n\r\n@Component({\r\n  templateUrl: 'dashboard.component.html',\r\n})\r\nexport class DashboardComponent implements OnInit {\r\n  isLoading: {\r\n    page\r\n  };\r\n  role: string;\r\n  currentUser: User;\r\n\r\n  leaderboard: UserWithScore[];\r\n  lateTasks: Task[];\r\n  needReviewTasks: Task[];\r\n  thisWeekTasks: Task[];\r\n  projects: Project[];\r\n\r\n  constructor(\r\n    private storeService: StoreService,\r\n    private projectService: ProjectService,\r\n    private teamService: TeamService,\r\n    private userService: UserService,\r\n    private router: Router,\r\n    private route: ActivatedRoute,\r\n    private location: Location,\r\n    private modalService: BsModalService\r\n  ) {\r\n    let currentUser = this.storeService.get(['currentUser']);\r\n    if (!currentUser.isAdmin && !currentUser.isManager) {\r\n      this.role = 'staff';\r\n    }\r\n    if (!currentUser.isAdmin && currentUser.isManager) {\r\n      this.role = 'manager';\r\n    }\r\n    if (currentUser.isAdmin && !currentUser.isManager) {\r\n      this.role = 'admin';\r\n    }\r\n    this.currentUser = currentUser;\r\n    this.isLoading = {\r\n      page: true\r\n    };\r\n  }\r\n\r\n  ngOnInit(): void {\r\n    this.userService.getLeaderBoard()\r\n      .then((value: UserWithScore[]) => {\r\n        this.leaderboard = value;\r\n        this.isLoading = {\r\n          page: false\r\n        };\r\n      })\r\n      .catch(reason => {\r\n        this.showErrorModal(reason.Message);\r\n      });\r\n\r\n    switch (this.role) {\r\n      case 'staff': {\r\n        this.loadStaffSection();\r\n        break;\r\n      }\r\n      case 'manager': {\r\n        this.loadManagerSection();\r\n        break;\r\n      }\r\n      case 'admin': {\r\n        this.loadAdminSection();\r\n        break;\r\n      }\r\n    }\r\n  }\r\n\r\n  private loadStaffSection() {\r\n    Promise.all([\r\n      this.userService.getCurrentUserLateTasks(),\r\n      this.userService.getCurrentUserNearExpireTask(),\r\n      this.userService.getLeaderBoard()])\r\n      .then((resData: [Task[], Task[], UserWithScore[]]) => {\r\n        this.lateTasks = resData[0];\r\n        this.thisWeekTasks = resData[1];\r\n        this.leaderboard = resData[2];\r\n        this.isLoading.page = false;\r\n      })\r\n      .catch(reason => {\r\n        this.showErrorModal(reason.Message);\r\n      })\r\n  }\r\n\r\n  private loadManagerSection() {\r\n    Promise.all([\r\n      this.teamService.getLateTasks(this.currentUser.team.id),\r\n      this.teamService.getNeedReviewTasks(this.currentUser.team.id),\r\n      this.userService.getLeaderBoard()])\r\n      .then((resData: [Task[], Task[], UserWithScore[]]) => {\r\n        this.lateTasks = resData[0];\r\n        this.needReviewTasks = resData[1];\r\n        this.leaderboard = resData[2];\r\n        this.isLoading.page = false;\r\n      })\r\n      .catch(reason => {\r\n        this.showErrorModal(reason.Message);\r\n      })\r\n  }\r\n\r\n  private loadAdminSection() {\r\n    Promise.all([\r\n      this.projectService.getAllProjects(),\r\n      this.userService.getLeaderBoard()])\r\n      .then((resData: [Project[], UserWithScore[]]) => {\r\n        this.projects = resData[0];\r\n        this.leaderboard = resData[1];\r\n        this.isLoading.page = false;\r\n      })\r\n      .catch(reason => {\r\n        this.showErrorModal(reason.Message);\r\n      })\r\n  }\r\n\r\n\r\n  private showErrorModal(message: string, isNavigateBack: boolean = false) {\r\n    const initialState = {\r\n      closeCallback: () => {\r\n        if (isNavigateBack) {\r\n          this.location.back();\r\n        }\r\n      },\r\n      message: message\r\n    };\r\n    this.modalService.show(ErrorModalComponent, {initialState, class: 'modal-dialog modal-danger'});\r\n  }\r\n}\r\n\r\ninterface UserWithScore {\r\n  id: number,\r\n  name: string,\r\n  phone: string,\r\n  birthdate: string,\r\n  email: string,\r\n  username: string,\r\n  isAdmin: true,\r\n  isManager: false,\r\n  isActive: true\r\n  avatar: string,\r\n  score: number\r\n}\r\n\r\n\r\n\r\n\n\n\n// WEBPACK FOOTER //\n// D:/Project/AgencyProjectManagement/Web/Angular/src/app/views/dashboard/dashboard.component.ts","import {NgModule} from '@angular/core';\nimport {DashboardComponent} from './dashboard.component';\nimport {DashboardRoutingModule} from './dashboard-routing.module';\nimport {CommonModule} from '@angular/common';\nimport {SpinnerModule} from '../../components';\nimport {CmaModule} from '../../cmaComponents/cma.module';\n@NgModule({\n  imports: [\n    CommonModule,\n    DashboardRoutingModule,\n    SpinnerModule,\n    CmaModule\n  ],\n  declarations: [\n    DashboardComponent,\n  ],\n})\nexport class DashboardModule {\n}\n\n\n\n// WEBPACK FOOTER //\n// D:/Project/AgencyProjectManagement/Web/Angular/src/app/views/dashboard/dashboard.module.ts"],"sourceRoot":"webpack:///"}